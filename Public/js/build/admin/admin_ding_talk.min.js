$(function(){obj={dingtalk_update:function(){var t=Strack.validate_form("ding_talk_setting");if(200===parseInt(t.status)){var e={};for(var a in t.data)if(-1!=a.indexOf("endpoint_")){var n=a.split("-");e.hasOwnProperty(n[0])||(e[n[0]]={}),e[n[0]][n[1]]=t.data[a]}!1===$.isEmptyObject(e)&&$.ajax({type:"POST",url:DingTalkPHP.updateDingTalkConfig,data:JSON.stringify(e),dataType:"json",contentType:"application/json",beforeSend:function(){$.messager.progress({title:StrackLang.Waiting,msg:StrackLang.loading})},success:function(t){$.messager.progress("close"),200===parseInt(t.status)?Strack.top_message({bg:"g",msg:t.message}):layer.msg(t.message,{icon:7,time:1200,anim:6})}})}},add_company_node:function(t){var e=i(n,{node_name:"",corp_id:"",app_key:"",app_secret:"",control_department:""});$("#cloud_disk_list").append(e.dom),d("endpoint_val_control_department_"+e.random_id)},delete_dingtalk_item:function(t){$(t).closest(".cloud-e-item").remove(),obj.dingtalk_update()}};var n=$("#rules_submit").val();function i(t,e){var a="",n=Math.floor(1e4*Math.random()+1);for(var i in a+='<div class="cloud-e-item">',"yes"===t&&(a+='<a href="javascript:;" class="e-del-bnt" onclick="obj.delete_dingtalk_item(this)"><i class="icon-uniE6752"></i></a>'),e)a+=("control_department"===i?r:o)(n,t,i,e[i],"Ding_Talk_"+Strack.string_ucwords(i),"Ding_Talk_Notice_"+Strack.string_ucwords(i));return{dom:a+="</div>",random_id:n}}function o(t,e,a,n,i,o){var r="";return'<div class="e-item-input stcol-lg-2">'+(r+="yes"===e?'<input id="endpoint_val_'+a+"_"+t+'" class="form-control form-input" wiget-type="input" wiget-need="yes" wiget-field="endpoint_'+t+"-"+a+'" wiget-name="'+StrackLang[i]+'" autocomplete="off" placeholder="'+StrackLang[o]+'" value="'+n+'">':'<input class="form-control form-input input-disabled" disabled="disabled" placeholder="'+StrackLang[o]+'" value="'+n+'">')+"</div>"}function r(t,e,a,n,i,o){var r="";return'<div class="e-item-input stcol-lg-2">'+(r+="yes"===e?'<input id="endpoint_val_'+a+"_"+t+'" class="form-input" wiget-type="combobox_s" wiget-need="yes" wiget-field="endpoint_'+t+"-"+a+'" wiget-name="'+StrackLang[i]+'" autocomplete="off" placeholder="'+StrackLang[o]+'" value="'+n+'">':'<input id="endpoint_val_'+a+"_"+t+'" class="form-input" data-options="disabled:true" placeholder="'+StrackLang[o]+'" value="'+n+'">')+"</div>"}function d(t){Strack.combobox_widget("#"+t,{url:DingTalkPHP.getDepartmentList,valueField:"id",textField:"name",width:489,height:39,multiple:!0,prompt:StrackLang.Ding_Talk_Notice_Control_Department})}$.ajax({type:"POST",url:DingTalkPHP.getDingTalkConfig,dataType:"json",success:function(t){if(!1===$.isEmptyObject(t)){var e="";for(var a in t)e=i(n,t[a]),$("#cloud_disk_list").append(e.dom),d("endpoint_val_control_department_"+e.random_id)}}})});