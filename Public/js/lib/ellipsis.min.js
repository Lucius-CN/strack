(function(l){l.fn.ellipsis=function(b){b=l.extend({row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"},b);this.each(function(){var c=l(this),a=c.text(),h=a,g=h.length,e=c.height();c.text("a");var f=parseFloat(c.css("lineHeight"),10),d=c.height();f=(f>d?f-d:0)*(b.row-1)+d*b.row;if(e<=f)c.text(a),c.css("height",34);else{e=1;var k=a.length;if("tail"===b.position){for(;e<k;)d=Math.ceil((e+k)/2),c.text(a.slice(0,d)+b["char"]),c.height()<=f?e=d:k=d-1;a=a.slice(0,e);b.onlyFullWords&&
(a=a.replace(/[\u00AD\w\uac00-\ud7af]+$/,""));a+=b["char"]}else if("middle"===b.position){for(;e<k;)d=Math.ceil((e+k)/2),a=Math.max(g-d,0),c.text(h.slice(0,Math.floor((g-a)/2))+b["char"]+h.slice(Math.floor((g+a)/2),g)),c.height()<=f?e=d:k=d-1;a=Math.max(g-e,0);f=h.slice(0,Math.floor((g-a)/2));h=h.slice(Math.floor((g+a)/2),g);b.onlyFullWords&&(f=f.replace(/[\u00AD\w\uac00-\ud7af]+$/,""));a=f+b["char"]+h}c.css("height",34);c.text(a)}b.callback.call(this)});return this}})(jQuery);